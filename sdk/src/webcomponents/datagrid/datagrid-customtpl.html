<link rel="import" href="/lib/polymer/polymer.html">

<dom-module id="bc-datagrid-customtpl">
    <script type="text/javascript" src="/src/helper.js"></script>
    <script type="text/javascript" src="/src/webcomponents/components.js"></script>

    <script>
        var webComponent = {
            "is": "bc-datagrid-customtpl",
            "properties": {
                item: Object,
                col: Object
            },
            ready: function() {
                var content = document.createElement("div"),
                    self = this;
                content.innerHTML = this.col.template;

                var domBind = document.createElement('template', 'dom-bind');
                domBind.item = this.item;
                domBind.col = this.col;
                domBind.getItemValue = function(item, property) {
                    console.log(property);
                    return self.getItemValue(item, property);
                }

                domBind.content.appendChild(content);

                Polymer.dom(this).appendChild(domBind);
            },
            getItemValue: function(item, itemProperty) {
                var propertyParts = itemProperty.split(".");

                for (var idx = 0; idx < propertyParts.length; idx++) {
                    item = item[propertyParts[idx]];

                    if (!item) {
                        return;
                    }
                }

                return item;
            }
        };

        webComponent = BCAPI.Components.ComponentsFactory.get(webComponent);

        Polymer(webComponent);
    </script>
</dom-module>