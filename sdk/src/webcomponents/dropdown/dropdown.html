<link rel="import" href="/lib/polymer/polymer.html">

<dom-module id="bc-select">
    <style type="text/css">
        .select-model {
            display: none;
        }
    </style>

    <template>
        <div id="selectModel" class="select-model">
            <content></content>
        </div>

        <select class="form-control" id="orderBy" on-change="handleChange">
            <template is="dom-repeat" items="{{items}}">
                <option value="{{item.value}}" text="{{item.text}}"></option>
            </template>
        </select>
    </template>

    <script type="text/javascript" src="/src/helper.js"></script>
    <script type="text/javascript" src="/src/webcomponents/components.js"></script>

    <script>
    var webComponent = {
        is: "bc-select",
        properties: {
            items: Array
        },
        ready: function() {
            var options = this.$.selectModel.querySelectorAll("option"),
                items = [];

            for (var idx = 0; idx < options.length; idx++) {
                var option = options[idx],
                    item = {"value": option.value, "text": option.text};

                items.push(item);
            };

            this.configure({"items": items});
        },
        getValue: function() {
            return this.items[this.$.orderBy.selectedIndex];
        },
        handleChange: function(evt) {
            var selectedItem = this.getValue();

            this.trigger("dd:change", selectedItem);
        },
        configure: function(opts) {
            this.items = opts.items || items;
        }
    };

    webComponent = BCAPI.Components.ComponentsFactory.get(webComponent);

    BCAPI.Components.DropDown = Polymer(webComponent);
    </script>
</dom-module>