<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: webcomponents/dropdown/dropdown.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: webcomponents/dropdown/dropdown.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * This class offers a flexible drop down component which has BC look &amp; feel. In comparison with standard HTML select,
 * this component benefit from [advanced data sources]{@link BCAPI.Components.DataSources} provided by UI SDK.
 *
 * ## Properties
 *
 * Below you can find a complete list of properties which can be configured for this component:
 *
 * | Property name | Property description |
 * | ------------------- | -------------------------- |
 * | items | An array providing the items which must be displayed in the dropdown. |
 * | valueProp | A string telling which is the value property which must be extracted from each item. |
 * | textProp | A string telling which is the text property which must be extracted from each item and displayed to users. |
 *
 * ## Events
 *
 * | Event name.| Event description |
 * |---------------------------------|---------------------------------|
 * | changed | This event is triggered whenever dropdown selection is changed. |
 * | dataLoaded | This event is triggered whenever dropdown is configured with an asynchronous data source. See {@link BCAPI.Components.DataSources} |
 *
 * ## Usage
 *
 * ### Html markup
 *
 * ```html
 * &lt;bc-select id="ddOrderBy">
 *   &lt;option value="0">Order by&lt;/option>
 *   &lt;option value="id">Customer Id&lt;/option>
 *   &lt;option value="firstName">First Name&lt;/option>
 *   &lt;option value="middleName">Middle Name&lt;/option>
 *   &lt;option value="lastName">Last Name&lt;/option>
 * &lt;/bc-select>
 * ```
 *
 * ### Html markup + javascript
 *
 * ```html
 * &lt;bc-select id="ddOrderBy">&lt;/bc-select>
 *
 * &lt;script type="text/javascript">
 * document.addEventListener('WebComponentsReady', function() {
 *     var orderByDd = document.getElementById("ddOrderBy");
 *
 *     orderByDd.configure({
 *         items: [
 *                 {"value": "0", "text": "Order by"},
 *                 {"value": "id", "text": "Customer Id"},
 *                 {"value": "firstName", "text": "Order by"},
 *                 {"value": "middleName", "text": "Middle name"},
 *                 {"value": "lastName", "text": "Last name"},
 *                 {"value": "homePhone", "text": "Phone number"}
 *        ]
 *     });
 * });
 * &lt;/script>
 * ```
 *
 * ### Javascript only
 *
 * ```javascript
 * var orderByDd = document.createElement("bc-select");
 *
 * orderByDd.configure({
 *     items: [
 *         {"value": "0", "text": "Order by"},
 *         {"value": "id", "text": "Customer Id"},
 *         {"value": "firstName", "text": "Order by"},
 *         {"value": "middleName", "text": "Middle name"},
 *         {"value": "lastName", "text": "Last name"},
 *         {"value": "homePhone", "text": "Phone number"}
 *    ]
 * });
 * ```
 *
 * @name DropDown
 * @class
 * @public
 * @memberof BCAPI.Components
 * @augments BCAPI.Components.Component
 */
var webComponent = (function() {
    EVT_CHANGED = "changed";
    EVT_DATA_LOADED = "dataLoaded";

    var webComponent = {
        is: "bc-select",
        properties: {
            items: {
                type: Array,
                notify: true,
                observer: "_refreshItemsSelect"
            },
            valueProp: {
                type: String,
                value: "value"
            },
            textProp: {
                type: String,
                value: "text"
            },
            "class": {
                type: String,
                notify: true,
                observer: "_changeClass"
            },
            dataSource: {
                type: Object,
                notify: true,
                observer: "_buildFromDataSource"
            },
            supportsDataSource: {
                readOnly: true,
                type: Boolean,
                value: true
            }
        },
        customEvents: [
            EVT_CHANGED,
            EVT_DATA_LOADED
        ],
        /**
         * This method is invoked automatically when the component is ready to be used. At this point the component has not
         * been attached to the main dom. Internally, the method uses the shadow dom and tries to configure dataSource
         * and render all required items.
         *
         * @public
         * @instance
         * @method  ready
         * @return {undefined} No result.
         * @memberof BCAPI.Components.DropDown
         */
        ready: function() {
            this._innerSelect = this.$.ddItemsHolder;
            this.class = "form-control";

            var options = this.$.selectModel.querySelectorAll("option"),
                items;

            if (options.length > 0) {
                items = this._buildFromMarkup(options);

                this.configure({
                    "items": items
                });

                return;
            }

            this._wireDataSourceFromMarkup();
        },
        /**
         * This method obtains the current selected item.
         *
         * @public
         * @instance
         * @method getValue
         * @return {Object} The selected item.
         * @memberof BCAPI.Components.DropDown
         */
        getValue: function() {
            var items = this.items || [],
                selectedIndex = this.$.ddItemsHolder.selectedIndex;

            if (selectedIndex &lt; 0 || selectedIndex > items.length) {
                return undefined;
            }

            return items[selectedIndex];
        },
        /**
         * This method sets the current value from the dropdown.
         *
         * @param {Object} newValue The new value used for setting the correct selectedIndex.
         * @returns {Boolean} True if the value was correctly set and false if the value does not match any of the items available in the dropdown.
         * @memberof BCAPI.Components.DropDown
         */
        setValue: function(newValue) {
            var itemIdx = -1,
                items = this.items || [];

            for (var idx = 0; idx &lt; items.length; idx++) {
                var currItem = items[idx];

                if (currItem[this.valueProp] === newValue) {
                    itemIdx = idx;
                    break;
                }
            }

            if (itemIdx > -1) {
                this.$.ddItemsHolder.selectedIndex = itemIdx;
                this._handleChange();
            }
            
            return itemIdx > -1;
        },
        /**
         * This method provides a way to quickly configure the current dropdown.
         *
         * @public
         * @method configure
         * @instance
         * @param  {Object} opts All properties which must be set to the current dropdown instance.
         * @return {undefined} No result.
         * @memberof BCAPI.Components.DropDown
         * @example
         * var dropDown = document.createElement("bc-select");
         * dropDown.configure({
         *     "items": [
         *         {"value": "0", "text": "Order by"}
         *     ]
         * });
         */
        configure: function(opts) {
            this.items = opts.items || this.items;
            this.dataSource = opts.dataSource || this.dataSource;
        },
        /**
         * This method is invoked in order to handle item selection changed event triggerd by the inner select element.
         *
         * @private
         * @instance
         * @method handleChange
         * @param  {Event} evt The dom event emmited by the inner dropdown dom element.
         * @return {undefined} No result.
         * @memberof BCAPI.Components.DropDown
         */
        _handleChange: function(evt) {
            var selectedItem = this.getValue();

            this.trigger(EVT_CHANGED, selectedItem);
        },
        /**
         * This method obtains the items defined using the markup approach for this component.
         *
         * @private
         * @instance
         * @method  _buildFromMarkup
         * @param  {options} options The options object used for obtaining the items defined in markup.
         * @return {Array} The items obtained from the markup.
         * @memberof BCAPI.Components.DropDown
         */
        _buildFromMarkup: function(options) {
            var items = [];

            for (var idx = 0; idx &lt; options.length; idx++) {
                var option = options[idx],
                    item = {
                        "value": option.value,
                        "text": option.text,
                        "selected": option.selected
                    };

                items.push(item);
            }

            return items;
        },
        /**
         * This method builds the items which must be rendered from the internally defined dataSource. It wires an async
         * listener to the data source events and renders all items when necessary.
         *
         * @private
         * @instance
         * @method _buildFromDataSource
         * @param  {BCAPI.Components.DataSource} dataSource The data source which must be used for obtaining the items.
         * @return {undefined} No result.
         * @memberof BCAPI.Components.DropDown
         */
        _buildFromDataSource: function(dataSource) {
            var loader = dataSource.list(),
                self = this;

            if (!loader) {
                return;
            }

            loader.done(function(data) {
                self._fetched = true;
                self._updateData(data);

                self.trigger(EVT_DATA_LOADED, {});
            });
        },
        /**
         * This method updates the currently displayed data with new values provided through data argument.
         *
         * @private
         * @instance
         * @method _updateData
         * @param  {Object} data The new data which must be rendered within the component. All relevant records must be placed under items property belonging to data.
         * @return {undefined} No result.
         */
        _updateData: function(data) {
            var items = data.items,
                rows = [];

            for (var idx = 0; items &amp;&amp; idx &lt; items.length; idx++) {
                var row = {},
                    item = items[idx];

                row.value = item[this.valueProp];
                row.text = item[this.textProp];

                rows.push(row);
            }

            this.configure({
                "items": rows
            });
        },
        /**
         * This method is invoked whenever items must be rendered.
         *
         * @private
         * @instance
         * @method  _refreshItemsSelect
         * @param  {Array} items An array of items which must be displayed.
         * @return {undefined} No result.
         * @memberof BCAPI.Components.DropDown
         */
        _refreshItemsSelect: function(items) {
            var select = this.$.ddItemsHolder;

            select.options.length = 0;

            for (var i = 0; i &lt; items.length; i++) {
                var option = document.createElement("option");
                option.value = items[i].value;
                option.selected = items[i].selected;
                option.textContent = items[i].text;

                select.add(option);
            }
        },
        /**
         * This method handles the change of css classes applied to the current dropdown instance.
         *
         * @private
         * @instance
         * @method  _changeClass
         * @param  {String} newClass A whitespace separated list of classes.
         * @return {undefined} No result.
         * @memberof BCAPI.Components.DropDown
         */
        _changeClass: function(newClass) {
            this.__base.changeClass(newClass, this._innerSelect);
        }
    };

    webComponent = BCAPI.Components.ComponentsFactory.get(webComponent);

    return webComponent;
})();</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="BCAPI.Components.Button.html">Button</a></li><li><a href="BCAPI.Components.Component.html">Component</a></li><li><a href="BCAPI.Components.ComponentsFactory.html">ComponentsFactory</a></li><li><a href="BCAPI.Components.DataGrid.html">DataGrid</a></li><li><a href="BCAPI.Components.DataSources.DataSource.html">DataSource</a></li><li><a href="BCAPI.Components.DataSources.JsonDataSource.html">JsonDataSource</a></li><li><a href="BCAPI.Components.DropDown.html">DropDown</a></li><li><a href="BCAPI.Components.Exceptions.NotImplementedException.html">NotImplementedException</a></li><li><a href="BCAPI.Components.Exceptions.WireEventException.html">WireEventException</a></li><li><a href="BCAPI.Components.TextField.html">TextField</a></li><li><a href="BCAPI.Models.Category.html">Category</a></li><li><a href="BCAPI.Models.CategoryCollection.html">CategoryCollection</a></li><li><a href="BCAPI.Models.Collection.html">Collection</a></li><li><a href="BCAPI.Models.Country.html">Country</a></li><li><a href="BCAPI.Models.CountryCollection.html">CountryCollection</a></li><li><a href="BCAPI.Models.FileSystem.File.html">File</a></li><li><a href="BCAPI.Models.FileSystem.Folder.html">Folder</a></li><li><a href="BCAPI.Models.Model.html">Model</a></li><li><a href="BCAPI.Models.WebApp.AppCollection.html">AppCollection</a></li><li><a href="BCAPI.Models.WebApp.Country.html">Country</a></li><li><a href="BCAPI.Models.WebApp.CustomField.html">CustomField</a></li><li><a href="BCAPI.Models.WebApp.CustomFieldCollection.html">CustomFieldCollection</a></li><li><a href="BCAPI.Models.WebApp.Item.html">Item</a></li><li><a href="BCAPI.Models.WebApp.ItemCategory.html">ItemCategory</a></li><li><a href="BCAPI.Models.WebApp.ItemCollection.html">ItemCollection</a></li></ul><h3>Namespaces</h3><ul><li><a href="BCAPI.html">BCAPI</a></li><li><a href="BCAPI.Components.html">Components</a></li><li><a href="BCAPI.Components.DataSources.html">DataSources</a></li><li><a href="BCAPI.Components.Exceptions.html">Exceptions</a></li><li><a href="BCAPI.Components.Validation.html">Validation</a></li><li><a href="BCAPI.Config.html">Config</a></li><li><a href="BCAPI.Config.Pagination.html">Pagination</a></li><li><a href="BCAPI.Helper.html">Helper</a></li><li><a href="BCAPI.Helper.Http.html">Http</a></li><li><a href="BCAPI.Helper.Site.html">Site</a></li><li><a href="BCAPI.Messaging.html">Messaging</a></li><li><a href="BCAPI.Models.html">Models</a></li><li><a href="BCAPI.Models.FileSystem.html">FileSystem</a></li><li><a href="BCAPI.Models.WebApp.html">WebApp</a></li><li><a href="BCAPI.Security.html">Security</a></li></ul><h3>Tutorials</h3><ul><li><a href="tutorial-get-started.html">Get started with web components.</a></li><li><a href="tutorial-legacy-apis.html">List of legacy apis</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0-dev</a> on Wed Sep 09 2015 06:54:46 GMT+0300 (EEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
