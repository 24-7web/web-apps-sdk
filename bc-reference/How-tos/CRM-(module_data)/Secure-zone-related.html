<h1>Secure zone related</h1>
<div id="list-secure-zones">
    <h2>List the logged in urser's secure zones access</h2>
    <div class="description">
    <p>List the list of secure zones the currently logged in username has access to:</p>
    
</div>
    <div class="sample">
        <pre class="language-javascript"><code> &#123;module_data resource=&quot;customers&quot; version=&quot;v3&quot; collection=&quot;customerInfo&quot; fields=&quot;id,firstName,middleName,lastName,email1,email2,email3,username,mobilePhone,wholesaler&quot; where=&quot;\{&#39;$or&#39;:\[\{&#39;email1.value&#39;: &#39;&#123;&#123;this.globals.user.email&#125;&#125;&#39;\},\{&#39;email2.value&#39;: &#39;&#123;&#123;this.globals.user.email&#125;&#125;&#39;\},\{&#39;email3.value&#39;: &#39;&#123;&#123;this.globals.user.email&#125;&#125;&#39;\}\]\}&quot;}
&#123;&#37;assign userInfo = customerInfo.items[0]&#37;&#125;

 &#123;module_data resource=&quot;customers&quot; subresource=&quot;securezones&quot; resourceId=&quot;&#123;&#123;userInfo.id&#125;&#125;&quot; version=&quot;v3&quot; template=&quot;&quot; collection=&quot;customerZones&quot;}

&#123;&#37; if customerZones.totalItemsCount &gt; 0 &#37;&#125;
	&lt;table&gt;
		&lt;tbody&gt;
		&#123;&#37; for item in customerZones.items &#37;&#125;
			&lt;tr&gt;
				&lt;td&gt;&#123;&#123;item.zoneId&#125;&#125;&lt;/td&gt;
				&lt;td&gt;&#123;&#123;item.secureZone.name&#125;&#125;&lt;/td&gt;
				&lt;td&gt;&#123;&#37;if &#123;&#123;item.secureZone.sellAccess&#125;&#125;  == false&#37;&#125;Paid access&#123;&#37;else&#37;&#125;Free access &#123;&#37;endif&#37;&#125;&lt;/td&gt;
			&lt;/tr&gt;
		&#123;&#37; endfor &#37;&#125;
		&lt;/tbody&gt;
	&lt;/table&gt;
&#123;&#37; endif &#37;&#125;</code></pre>
    </div>
    <div class="sample-details">
    <p>In this example we first retrieve the customer details for the logged in user and then feed that data to the next instance of the <a href="/dev-assets/reference/module-reference/general/module_data.html">module_data</a> in the <em>resourceId</em> parameter.</p>
    <p>We then check to see if there are any secure zones the customer is subscribed to using the <em>customerZones.totalItemsCount</em> value and if there are more than 1 we draw the table.</p>
</div></div>

<div id="check-specific-page">
    <h2>Check if the currently logged in user has access to a particular page</h2>    
    <div class="description">
   <p>In the example below we will create a table that lists the secure zones and the pages for each secure zone the currently logged in user has access to:</p>
    
    
    </div>
    <div class="sample">
    <pre class="language-javascript"><code>
 &#123;module_data resource=&quot;customers&quot; subresource=&quot;securezones&quot; resourceId=&quot;&#123;&#123;globals.user.entityId&#125;&#125;&quot; version=&quot;v3&quot; template=&quot;&quot; collection=&quot;customerZones&quot;}
//get the list of secure zones this customer is subscribed to

&#123;&#37; if customerZones.totalItemsCount &gt; 0 &#37;&#125;
//if there is more than 1 secure zone go ahead
  &lt;table&gt;
    &lt;thead&gt;
      &lt;th&gt;Secure zone id&lt;/th&gt;
      &lt;th&gt;Secure zone name&lt;/th&gt;
      &lt;th&gt;Secure zone payment type&lt;/th&gt;
      &lt;th&gt;Grants access to the pages&lt;/th&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
      &#123;&#37; for item in customerZones.items &#37;&#125;
//loop the secure zones the customer is subscribed to 
      &lt;tr&gt;
        &lt;td&gt;&#123;&#123;item.zoneId&#125;&#125;&lt;/td&gt;
        &lt;td&gt;&#123;&#123;item.secureZone.name&#125;&#125;&lt;/td&gt;
        &lt;td&gt;&#123;&#37;if item.secureZone.sellAccess  == true&#37;&#125;Paid access&#123;&#37;else&#37;&#125;Free access &#123;&#37;endif&#37;&#125;&lt;/td&gt;
        
        &lt;td&gt; &#123;module_data resource=&quot;securezones&quot; subresource=&quot;pages&quot; resourceid=&quot;&#123;&#123;item.zoneId&#125;&#125;&quot; version=&quot;v3&quot; template=&quot;&quot; collection=&quot;szPages&quot;}
//get the list of secured pages for the current secure zone. The item.zoneId is the ID of the current secure zone        
        &#123;&#37; if &#123;&#123;szPages.totalItemsCount&#125;&#125; != 0 &#37;&#125;
//check if there are any pages contained in the secure zone
        &lt;ul&gt;
            &#123;&#37;for pages in szPages.items&#37;&#125;
//loop over the secured pages and render the page ID and the page name
            &lt;li&gt;&#123;&#123;pages.page.id&#125;&#125; - &#123;&#123;pages.page.displayFileName&#125;&#125;&lt;/li&gt;
            &#123;&#37;endfor&#37;&#125;
        &lt;/ul&gt;
        &#123;&#37;else&#37;&#125;
//the secure zone does not contian any pages
        &lt;p&gt;Empty secure zone.&lt;/p&gt;
        &#123;&#37;endif&#37;&#125;
        &lt;/td&gt;
      &lt;/tr&gt;
      &#123;&#37; endfor &#37;&#125;
    &lt;/tbody&gt;
  &lt;/table&gt;
&#123;&#37;else&#37;&#125;
//the currently logged in user is not subscribed to any secure zones
&lt;p&gt;You ar enot subscribed to any secure zones yet.&lt;/p&gt;
&#123;&#37; endif &#37;&#125; </code></pre>

    </div>
    <div class="sample-details">
    First we retrieve the logged in customer's list of secure zones. If there are more than one secure zone this customer is subscribed to we draw the table and start looping them in order to list the pages the secure zones contain.
      <p>In order to list the pages in each secure zone we use another instance of module_data and pass <em>resource=&quot;securezones&quot;, subresource=&quot;pages&quot;</em> and <em>resourceid="&#123;&#123;item.zoneId&#125;&#125;"</em>. The latter, resourceId holds the current secure zone ID as the <a href="/dev-assets/reference/liquid-reference/reference/logic-tags.html#for">FOR loop</a> goes over all of them. </p>
</div></div>