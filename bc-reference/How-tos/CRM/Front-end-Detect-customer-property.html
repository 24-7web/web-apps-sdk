       <h1>Do something if...</h1>
<div id="check-customer-wholesaler">
    <h2>the logged in customer is a wholesaler</h2>
    <div class="description">
        <p>Display something if the currently logged in user is marked as a wholesaler:
        </p>
        
    </div>
    <div class="sample">
        <pre class="language-javascript"><code>{module_webresource resource=&quot;customers&quot; version=&quot;v3&quot; template=&quot;&quot; collection=&quot;customerInfo&quot; fields=&quot;id,firstName,middleName,lastName,email1,email2,email3,username,mobilePhone,wholesaler&quot; where=&quot;\{'$or':\[\{'email1.value': '{{this.globals.user.email}}'\},\{'email2.value': '{{this.globals.user.email}}'\},\{'email3.value': '{{this.globals.user.email}}'\}\]\}&quot;}
{%assign userInfo = customerInfo.items[0]%}<br>{{userInfo.wholesaler | json}}<br>&lt;p&gt;{% if userInfo.wholesaler %}This customer is a wholesaler{% else %}This customer is not a wholesaler{% endif %}&lt;/p&gt;</code></pre>
    </div>
    <div class="sample-details">
    <p>In this example we get the customer resource that matches the condition specified by the <em>where</em> parameter.</p>
        <p>The condition <code>where=&quot;\{'$or':\[\{'email1.value': '{{this.globals.user.email}}'\},\{'email2.value': '{{this.globals.user.email}}'\},\{'email3.value': '{{this.globals.user.email}}'\}\]\}&quot;</code></p>
        <p>basically means</p>
        <p><code>(email1.value == this.globals.user.email) || (email1.value == this.globals.user.email) || (email1.value == this.globals.user.email)</code></p>
        <p>By using the where condition above along with the <em>module_webresource resource=&quot;customers&quot;</em> module we are looking for a customer entity that has any of the email address (customer entities have 3 mail addresses) identical to the address of the logged in customer.</p>
        <p>Once we find that customer entity we return the custom fields specified by the <em>fields</em> parameter and for ease of use we create the <em>userInfo </em>liquid variable and assign it the properties of the customer.</p>
        <p>We can now test against the <em>userInfo.wholesaler</em> property and check whether it returns <em>true</em> or <em>false</em></p>
        </div>
</div>

<div id="check-order-value">
    <h2>the logged in customer has order over $100</h2>
    <div class="description">
        <p>Display something if the currently logged in user has at least one order with the value over $100:</p>
        
  </div>
    <div class="sample">
        <pre class="language-javascript"><code>{module_webresource resource=&quot;customers&quot; version=&quot;v3&quot; template=&quot;&quot; collection=&quot;customerInfo&quot; fields=&quot;id,firstName,middleName,lastName,email1,email2,email3,username,mobilePhone,wholesaler&quot; where=&quot;\{'$or':\[\{'email1.value': '{{this.globals.user.email}}'\},\{'email2.value': '{{this.globals.user.email}}'\},\{'email3.value': '{{this.globals.user.email}}'\}\]\}&quot;}
{%assign userInfo = customerInfo.items[0]%}
{module_webresource resource=&quot;customers&quot; version=&quot;v3&quot; resourceId=&quot;{{userInfo.id}}&quot; subresource=&quot;orders&quot; template=&quot;&quot; limit=&quot;1&quot; collection=&quot;customerOrders&quot; where=&quot;\{'totalPrice':\{'$gte': 50 \}\}&quot; fields=&quot;id,status,totalPrice&quot;}
&lt;p&gt;{% if customerOrders.totalItemsCount &gt; 0 %}Customer has at least 1 order over $50{% else %}Customer does not have an order over $50{% endif %}&lt;/p&gt;</code></pre>
    </div>
    <div class="sample-details">
    <p>In this example we first retrieve the customer details for the logged in user and then feed that data to the next instance of the <a href="/dev-assets/reference/module-reference/general/module_webresource.html">module_webresource</a> in the <em>resourceId</em> parameter.</p>
        <p>We will then use the <code>limit=&quot;1&quot;</code> parameter because we don't need to know how many orders over $100 the customer has, we want to see if there is at least one order.</p></div>
</div>

<div id="check-orders-number">
  <h2>the logged in customer has more than 5 orders</h2>
  <div class="description">
    <p>Display something if the currently logged in user has more than 5 orders placed on this site:</p>
   
  </div>
    <div class="sample">
        <pre class="language-javascript"><code>{module_webresource resource=&quot;customers&quot; version=&quot;v3&quot; template=&quot;&quot; collection=&quot;customerInfo&quot; fields=&quot;id,firstName,middleName,lastName,email1,email2,email3,username,mobilePhone,wholesaler&quot; where=&quot;\{'$or':\[\{'email1.value': '{{this.globals.user.email}}'\},\{'email2.value': '{{this.globals.user.email}}'\},\{'email3.value': '{{this.globals.user.email}}'\}\]\}&quot;}
{%assign userInfo = customerInfo.items[0]%}
{module_webresource resource=&quot;customers&quot; version=&quot;v3&quot; resourceId=&quot;{{userInfo.id}}&quot; subresource=&quot;orders&quot; template=&quot;&quot; collection=&quot;customerOrders&quot; limit=&quot;5&quot; fields=&quot;id,status,totalPrice&quot;}
&lt;p&gt;{% if customerOrders.totalItemsCount &gt; 4 %}Customer has 5 or more orders{% else %}Customer has less than 5 orders{% endif %} -  ({{customerOrders.totalItemsCount}} to be exact)&lt;/p&gt;</code></pre>
    </div>
    <div class="sample-details">
     <p>In this example we first retrieve the customer details for the logged in user and then feed that data to the next instance of the <a href="/dev-assets/reference/module-reference/general/module_webresource.html">module_webresource</a> in the <em>resourceId</em> parameter.</p>
    <p>Then we retrieve 5 of the customer's orders. We add the limit for performance reasons, there is no point in getting all the orders if we only need to check if there are more then 5 items. We then compare the total numer of items retrieved with 4 and display different texts based on the outcome of the comparison.</p>
</div></div>

<div id="check-customer-product">
  <h2>the logged in customer has ever ordered a particular product</h2>
  <div class="description">
        <p>Display something if the currently logged in user has ever placed an order that contains a specific product:</p>
</div>
   
  <div class="sample">
        <pre class="language-javascript"><code>{module_webresource resource=&quot;customers&quot; version=&quot;v3&quot; template=&quot;&quot; collection=&quot;customerInfo&quot; fields=&quot;id,firstName,middleName,lastName,email1,email2,email3,username,mobilePhone,wholesaler&quot; where=&quot;\{&#39;$or&#39;:\[\{&#39;email1.value&#39;: &#39;{{this.globals.user.email}}&#39;\},\{&#39;email2.value&#39;: &#39;{{this.globals.user.email}}&#39;\},\{&#39;email3.value&#39;: &#39;{{this.globals.user.email}}&#39;\}\]\}&quot;}
//get the currently logged user information 

{%assign userInfo = customerInfo.items[0]%} 
//assign it to the userInfo variable for ease of use

{module_webresource resource=&quot;customers&quot; version=&quot;v3&quot; resourceId=&quot;{{userInfo.id}}&quot; subresource=&quot;orders&quot; template=&quot;&quot; collection=&quot;customerOrders&quot; fields=&quot;id,status,totalPrice&quot;}
//get the list of orders for the customer

{% for item in customerOrders.items %}
//loop the orders in order to search for the product

    {module_webresource resource=&quot;orders&quot; version=&quot;v3&quot; resourceId=&quot;{{item.id}}&quot; subresource=&quot;products&quot; template=&quot;&quot; collection=&quot;products&quot; where=&quot;\{&#39;product.id&#39;: &#39;9259226&#39;\}&quot;}
//get the individual product list for each order. It is at this time we need to pass the ID of the product we are filering by, in this case the ID is &#39;9259226&#39;
    {% if {{products.items[0].itemId}} %}
//if we find the product in the current order assign the value 1 to the variable &quot;found&quot;
        {%assign found = 1%}
    {%endif%}
{% endfor %}
        
        
{% if {{found}} == 1 %}
//if the variable &quot;found&quot; has been assigned the value 1 we know at least one of the customer's orders contains the product with the ID we were looking for
    True
{%else%}
    Not found
{%endif%}</code></pre>
    </div>
    <div class="sample-details">
    <p>In this example we first retrieve the customer details for the logged in user and then feed that data to the next instance of the <a href="/dev-assets/reference/module-reference/general/module_webresource.html">module_webresource</a> in the <em>resourceId</em> parameter.</p>
        <p>Next we get all the orders for this particular customer. Once we have the order we need to loop them and search for the individual products contained in the orders.</p>
</div></div>

<div id="check-customer-city">
    <h2>the logged in customer lives in a specific city</h2>
    <div class="description">
        <p>In the example below we  retrieve the customer details for the logged in user and then feed that data to the next instance of the <a href="/dev-assets/reference/module-reference/general/module_webresource.html">module_webresource</a> in the <em>resourceId</em> parameter.</p>
        <p>Then we retrieve the customer addresses sub resource and check if the <em>city</em> value is &quot;New York&quot; or &quot;NY&quot;.</p>
  </div>
    
    <div class="sample">
        <pre class="language-javascript"><code>{module_webresource resource=&amp;quot;customers&amp;quot; version=&amp;quot;v3&amp;quot; template=&amp;quot;&amp;quot; collection=&amp;quot;customerInfo&amp;quot; fields=&amp;quot;id,firstName,middleName,lastName,email1,email2,email3,username,mobilePhone,wholesaler&amp;quot; where=&amp;quot;\{'$or':\[\{'email1.value': '{{this.globals.user.email}}'\},\{'email2.value': '{{this.globals.user.email}}'\},\{'email3.value': '{{this.globals.user.email}}'\}\]\}&amp;quot;}
{%assign userInfo = customerInfo.items[0]%}
{module_webresource resource=&quot;customers&quot; subresource=&quot;addresses&quot; version=&quot;v3&quot; resourceId=&quot;{{userInfo.id}}&quot; template=&quot;&quot; collection=&quot;customerCity&quot; limit=&quot;1&quot;}
&lt;p&gt;{% if customerCity.items[0].city == &quot;NY&quot; or customerCity.items[0].city == &quot;New York&quot; %}Display the New York special offer.{% else %}Do not display the special offer{% endif %}&lt;/p&gt;</code></pre>
    </div>
</div>

<div id="check-customer-birthday">
    <h2>the logged in customer birthday is approaching</h2>
    <div class="description">
        <p>Display something if the difference between the current date and the customer's Date of Birth is less than X days.
        </p>
  </div>
   
    <div class="sample">
        <pre class="language-javascript"><code></code></pre>
    </div>
</div>